----------------------------------------------------------------------------------------------------
19-04-13 11:29:24
SEED = 1555126164
----------------------------------------------------------------------------------------------------
Options are printed as follows:
title = 'Tsinghua lecture experiment 1'
mode = 'train'  # 'train', 'test', 'restart', 'debug', 'export', 'input_train', 'input_test', 'speed_net'
seed = None
repeat = 1
delay = False  # start training after xxx minutes
gpu_list = [0]
batch_size = 128
interp = 0
dataset = 'mnist'  # 'mnist','svhn','cifar10', 'cifar100', 'imagenet', 'fashion'
preprocess = 'mnist'  # 'mnist', 'cifar', 'alexnet', 'inception_v2'
network = 'mlp'  # 'mlp', 'lenet', 'alexnet', 'densenet_test', 'resnet_test', 'mobilenet_v1', 'mobilenet_v2', shufflenet_v2
path_load = None
path_save = None   # None, False, True, or specify a dir
l2_decay = {'decay': 0e-4, 'exclude': ['depthwise']}
epoch_step = tf.Variable(1, name='epoch_step', trainable=False)
learning_step = tf.Variable(0, name='learning_step', trainable=False)
lr_decay = tf.train.cosine_decay(0.1, epoch_step, decay_steps=100)
loss_func = tf.losses.softmax_cross_entropy
optimizer = tf.train.MomentumOptimizer(lr_decay, 0.9, use_nesterov=True)
----------------------------------------------------------------------------------------------------
Single-GPU training with gpu 0
All parameters are pinned to GPU, all Ops are pinned to GPU
Training model on GPU 0
Perform input channel normalization in GPU for speed
No normalization in GPU for dataset mnist
Input data format is NHWC, convert to NCHW
/device:GPU:0 fc0/fc0_1 [784, 256]
/device:GPU:0 last/fc_last_1 [256, 10]
Parameters: 203264 {'fc': 203264}
MACs: 203264
MEMs: 0
No L2 weight decay
Testing model on GPU 0
Perform input channel normalization in GPU for speed
No normalization in GPU for dataset mnist
Input data format is NHWC, convert to NCHW
----------------------------------------------------------------------------------------------------
Epoch: 001 Loss: 0.235854 Train: 0.0702 Test: 0.0330 lr: 0.1000 FPS: 73795 
Epoch: 002 Loss: 0.096554 Train: 0.0290 Test: 0.0268 lr: 0.0999 FPS: 101478 B 
Epoch: 003 Loss: 0.064595 Train: 0.0194 Test: 0.0249 lr: 0.0998 FPS: 103706 B 
Epoch: 004 Loss: 0.048551 Train: 0.0149 Test: 0.0228 lr: 0.0996 FPS: 102956 B 
Epoch: 005 Loss: 0.036495 Train: 0.0114 Test: 0.0224 lr: 0.0994 FPS: 102323 B 
Epoch: 006 Loss: 0.026378 Train: 0.0077 Test: 0.0200 lr: 0.0991 FPS: 100828 B 
Epoch: 007 Loss: 0.020008 Train: 0.0057 Test: 0.0194 lr: 0.0988 FPS: 102434 B 
Epoch: 008 Loss: 0.015321 Train: 0.0040 Test: 0.0185 lr: 0.0984 FPS: 99955 B 
Epoch: 009 Loss: 0.010835 Train: 0.0024 Test: 0.0202 lr: 0.0980 FPS: 102816 
Epoch: 010 Loss: 0.008091 Train: 0.0015 Test: 0.0194 lr: 0.0976 FPS: 102256 
Epoch: 011 Loss: 0.005943 Train: 0.0008 Test: 0.0181 lr: 0.0970 FPS: 101099 B 
Epoch: 012 Loss: 0.003954 Train: 0.0004 Test: 0.0183 lr: 0.0965 FPS: 102628 
Epoch: 013 Loss: 0.002858 Train: 0.0002 Test: 0.0171 lr: 0.0959 FPS: 102353 B 
Epoch: 014 Loss: 0.002354 Train: 0.0001 Test: 0.0176 lr: 0.0952 FPS: 100803 
Epoch: 015 Loss: 0.001918 Train: 0.0000 Test: 0.0171 lr: 0.0946 FPS: 102483 B 
Epoch: 016 Loss: 0.001569 Train: 0.0000 Test: 0.0170 lr: 0.0938 FPS: 98748 B 
Epoch: 017 Loss: 0.001444 Train: 0.0000 Test: 0.0167 lr: 0.0930 FPS: 99103 B 
Epoch: 018 Loss: 0.001293 Train: 0.0000 Test: 0.0165 lr: 0.0922 FPS: 102656 B 
Epoch: 019 Loss: 0.001159 Train: 0.0000 Test: 0.0166 lr: 0.0914 FPS: 103284 
Epoch: 020 Loss: 0.001088 Train: 0.0000 Test: 0.0169 lr: 0.0905 FPS: 100889 
Epoch: 021 Loss: 0.001019 Train: 0.0000 Test: 0.0166 lr: 0.0895 FPS: 102260 
Epoch: 022 Loss: 0.000923 Train: 0.0000 Test: 0.0165 lr: 0.0885 FPS: 103208 
Epoch: 023 Loss: 0.000897 Train: 0.0000 Test: 0.0163 lr: 0.0875 FPS: 102494 B 
Epoch: 024 Loss: 0.000820 Train: 0.0000 Test: 0.0165 lr: 0.0864 FPS: 102418 
Epoch: 025 Loss: 0.000786 Train: 0.0000 Test: 0.0164 lr: 0.0854 FPS: 102531 
Epoch: 026 Loss: 0.000748 Train: 0.0000 Test: 0.0167 lr: 0.0842 FPS: 100803 
Epoch: 027 Loss: 0.000713 Train: 0.0000 Test: 0.0162 lr: 0.0831 FPS: 103084 B 
Epoch: 028 Loss: 0.000688 Train: 0.0000 Test: 0.0164 lr: 0.0819 FPS: 101455 
Epoch: 029 Loss: 0.000650 Train: 0.0000 Test: 0.0166 lr: 0.0806 FPS: 102252 
Epoch: 030 Loss: 0.000625 Train: 0.0000 Test: 0.0167 lr: 0.0794 FPS: 102142 
Epoch: 031 Loss: 0.000608 Train: 0.0000 Test: 0.0161 lr: 0.0781 FPS: 102295 B 
Epoch: 032 Loss: 0.000579 Train: 0.0000 Test: 0.0164 lr: 0.0768 FPS: 100703 
Epoch: 033 Loss: 0.000559 Train: 0.0000 Test: 0.0166 lr: 0.0755 FPS: 102863 
Epoch: 034 Loss: 0.000542 Train: 0.0000 Test: 0.0163 lr: 0.0741 FPS: 89478 
Epoch: 035 Loss: 0.000530 Train: 0.0000 Test: 0.0161 lr: 0.0727 FPS: 102428 
Epoch: 036 Loss: 0.000508 Train: 0.0000 Test: 0.0161 lr: 0.0713 FPS: 102397 
Epoch: 037 Loss: 0.000501 Train: 0.0000 Test: 0.0163 lr: 0.0699 FPS: 102436 
Epoch: 038 Loss: 0.000479 Train: 0.0000 Test: 0.0165 lr: 0.0684 FPS: 100578 
Epoch: 039 Loss: 0.000468 Train: 0.0000 Test: 0.0161 lr: 0.0669 FPS: 103185 B 
Epoch: 040 Loss: 0.000466 Train: 0.0000 Test: 0.0160 lr: 0.0655 FPS: 102682 B 
Epoch: 041 Loss: 0.000448 Train: 0.0000 Test: 0.0162 lr: 0.0639 FPS: 100541 
Epoch: 042 Loss: 0.000435 Train: 0.0000 Test: 0.0162 lr: 0.0624 FPS: 102459 
Epoch: 043 Loss: 0.000432 Train: 0.0000 Test: 0.0162 lr: 0.0609 FPS: 102902 
Epoch: 044 Loss: 0.000415 Train: 0.0000 Test: 0.0162 lr: 0.0594 FPS: 103260 
Epoch: 045 Loss: 0.000417 Train: 0.0000 Test: 0.0163 lr: 0.0578 FPS: 102403 
Epoch: 046 Loss: 0.000399 Train: 0.0000 Test: 0.0164 lr: 0.0563 FPS: 101310 
Epoch: 047 Loss: 0.000400 Train: 0.0000 Test: 0.0162 lr: 0.0547 FPS: 101164 
Epoch: 048 Loss: 0.000390 Train: 0.0000 Test: 0.0163 lr: 0.0531 FPS: 103182 
Epoch: 049 Loss: 0.000382 Train: 0.0000 Test: 0.0162 lr: 0.0516 FPS: 103590 
Epoch: 050 Loss: 0.000378 Train: 0.0000 Test: 0.0165 lr: 0.0500 FPS: 101167 
Epoch: 051 Loss: 0.000371 Train: 0.0000 Test: 0.0158 lr: 0.0484 FPS: 102550 B 
Epoch: 052 Loss: 0.000365 Train: 0.0000 Test: 0.0160 lr: 0.0469 FPS: 103058 
Epoch: 053 Loss: 0.000361 Train: 0.0000 Test: 0.0160 lr: 0.0453 FPS: 101536 
Epoch: 054 Loss: 0.000350 Train: 0.0000 Test: 0.0164 lr: 0.0437 FPS: 103292 
Epoch: 055 Loss: 0.000354 Train: 0.0000 Test: 0.0160 lr: 0.0422 FPS: 102898 
Epoch: 056 Loss: 0.000347 Train: 0.0000 Test: 0.0163 lr: 0.0406 FPS: 100738 
Epoch: 057 Loss: 0.000347 Train: 0.0000 Test: 0.0159 lr: 0.0391 FPS: 102152 
Epoch: 058 Loss: 0.000336 Train: 0.0000 Test: 0.0160 lr: 0.0376 FPS: 102372 
Epoch: 059 Loss: 0.000335 Train: 0.0000 Test: 0.0162 lr: 0.0361 FPS: 102434 
Epoch: 060 Loss: 0.000331 Train: 0.0000 Test: 0.0161 lr: 0.0345 FPS: 103251 
Epoch: 061 Loss: 0.000334 Train: 0.0000 Test: 0.0160 lr: 0.0331 FPS: 102916 
Epoch: 062 Loss: 0.000323 Train: 0.0000 Test: 0.0161 lr: 0.0316 FPS: 102287 
Epoch: 063 Loss: 0.000319 Train: 0.0000 Test: 0.0163 lr: 0.0301 FPS: 102759 
Epoch: 064 Loss: 0.000323 Train: 0.0000 Test: 0.0162 lr: 0.0287 FPS: 103113 
Epoch: 065 Loss: 0.000314 Train: 0.0000 Test: 0.0160 lr: 0.0273 FPS: 102369 
Epoch: 066 Loss: 0.000315 Train: 0.0000 Test: 0.0162 lr: 0.0259 FPS: 101828 
Epoch: 067 Loss: 0.000315 Train: 0.0000 Test: 0.0162 lr: 0.0245 FPS: 102903 
Epoch: 068 Loss: 0.000306 Train: 0.0000 Test: 0.0162 lr: 0.0232 FPS: 102264 
Epoch: 069 Loss: 0.000314 Train: 0.0000 Test: 0.0162 lr: 0.0219 FPS: 101680 
Epoch: 070 Loss: 0.000307 Train: 0.0000 Test: 0.0162 lr: 0.0206 FPS: 102253 
Epoch: 071 Loss: 0.000302 Train: 0.0000 Test: 0.0162 lr: 0.0194 FPS: 101713 
Epoch: 072 Loss: 0.000308 Train: 0.0000 Test: 0.0162 lr: 0.0181 FPS: 103580 
Epoch: 073 Loss: 0.000296 Train: 0.0000 Test: 0.0162 lr: 0.0169 FPS: 104184 
Epoch: 074 Loss: 0.000303 Train: 0.0000 Test: 0.0162 lr: 0.0158 FPS: 103170 
Epoch: 075 Loss: 0.000303 Train: 0.0000 Test: 0.0162 lr: 0.0146 FPS: 102081 
Epoch: 076 Loss: 0.000297 Train: 0.0000 Test: 0.0162 lr: 0.0136 FPS: 102608 
Epoch: 077 Loss: 0.000297 Train: 0.0000 Test: 0.0162 lr: 0.0125 FPS: 102370 
Epoch: 078 Loss: 0.000294 Train: 0.0000 Test: 0.0162 lr: 0.0115 FPS: 103207 
Epoch: 079 Loss: 0.000295 Train: 0.0000 Test: 0.0162 lr: 0.0105 FPS: 103275 
Epoch: 080 Loss: 0.000292 Train: 0.0000 Test: 0.0162 lr: 0.0095 FPS: 101161 
Epoch: 081 Loss: 0.000293 Train: 0.0000 Test: 0.0162 lr: 0.0086 FPS: 101930 
Epoch: 082 Loss: 0.000296 Train: 0.0000 Test: 0.0162 lr: 0.0078 FPS: 103067 
Epoch: 083 Loss: 0.000293 Train: 0.0000 Test: 0.0162 lr: 0.0070 FPS: 102397 
Epoch: 084 Loss: 0.000289 Train: 0.0000 Test: 0.0162 lr: 0.0062 FPS: 103366 
Epoch: 085 Loss: 0.000290 Train: 0.0000 Test: 0.0162 lr: 0.0054 FPS: 103524 
Epoch: 086 Loss: 0.000291 Train: 0.0000 Test: 0.0161 lr: 0.0048 FPS: 102103 
Epoch: 087 Loss: 0.000293 Train: 0.0000 Test: 0.0161 lr: 0.0041 FPS: 103185 
Epoch: 088 Loss: 0.000289 Train: 0.0000 Test: 0.0161 lr: 0.0035 FPS: 103145 
Epoch: 089 Loss: 0.000288 Train: 0.0000 Test: 0.0162 lr: 0.0030 FPS: 103561 
Epoch: 090 Loss: 0.000288 Train: 0.0000 Test: 0.0161 lr: 0.0024 FPS: 102854 
Epoch: 091 Loss: 0.000292 Train: 0.0000 Test: 0.0161 lr: 0.0020 FPS: 102427 
Epoch: 092 Loss: 0.000288 Train: 0.0000 Test: 0.0161 lr: 0.0016 FPS: 103068 
Epoch: 093 Loss: 0.000287 Train: 0.0000 Test: 0.0161 lr: 0.0012 FPS: 102998 
Epoch: 094 Loss: 0.000290 Train: 0.0000 Test: 0.0161 lr: 0.0009 FPS: 102886 
Epoch: 095 Loss: 0.000287 Train: 0.0000 Test: 0.0161 lr: 0.0006 FPS: 103158 
Epoch: 096 Loss: 0.000289 Train: 0.0000 Test: 0.0161 lr: 0.0004 FPS: 103238 
Epoch: 097 Loss: 0.000291 Train: 0.0000 Test: 0.0161 lr: 0.0002 FPS: 103830 
Epoch: 098 Loss: 0.000282 Train: 0.0000 Test: 0.0161 lr: 0.0001 FPS: 103099 
Epoch: 099 Loss: 0.000291 Train: 0.0000 Test: 0.0161 lr: 0.0000 FPS: 103403 
----------------------------------------------------------------------------------------------------
Optimization ended at 19-04-13 11:30:32
